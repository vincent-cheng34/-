import pandas as pd   #导入pandas数据库
x = pd.read_excel('./cumcm2018c1.xlsx')    #导入第一张表数据
x.shape   #第一张表查看数据形状
x.keys()    #第一张表查看键
#第一张表去重
x = x.drop_duplicates()    #无重复值
x
#第一张表缺失值处理
x.isnull().sum()   #第一张表有缺失值
x = x.dropna()   #第一张表删除缺失值
x     #打印
#第一张表异常值处理
x['csrq'].dtype    #查看出生日期的数据类型
pd.Timestamp.max    #查看时间的范围
#第二张表处理
y = pd.read_csv('./cumcm2018c2.csv')   #导入第二张表数据
y.shape     #第二张表查看数据形态
#第二张表异常值处理
y['je'].describe()
import matplotlib.pyplot as plt
p = plt.boxplot(y['je'])         #异常值箱线图
plt.show()
p['fliers'][0].get_ydata()  #提取异常值
#合并两张表
pd.merge(y,x,left_on = 'kh',right_on = 'kh')    #主键合并,left_on、right_on都是键
#任务2
task2 = pd.to_datetime(z['csrq'])   #将出生日期转换为时间格式
import datetime as dt   #导入模块
Now_year = dt.datetime.today().year    #今天的日期
Age = Now_year - task2.dt.year      #算出年龄
Age     #打印年龄
import matplotlib.pyplot as plt   #导入模块
